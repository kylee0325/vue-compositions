var K=Object.defineProperty;var h=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var b=(a,e,o)=>e in a?K(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o,v=(a,e)=>{for(var o in e||(e={}))x.call(e,o)&&b(a,o,e[o]);if(h)for(var o of h(e))T.call(e,o)&&b(a,o,e[o]);return a};import"./useHistory.d7897cc0.js";import{_ as C,n as k,l as F,r as u,c as I,a as l,w as c,x as w,F as L,y as N,d as j,o as O,e as S}from"./app.3968e24d.js";function P(a){return Object.assign({parentKey:"parent_id",childrenKey:"children",idKey:"id"},a)}function g(a,e=null,o){const t=P(o),f=[],p=a.map(r=>v({},r)),i={};return p.forEach(r=>{i[r[t.idKey]]=r}),p.forEach(r=>{const s=r[t.parentKey];s===e?f.push(r):i[s]&&(i[s][t.childrenKey]?i[s][t.childrenKey].push(r):i[s][t.childrenKey]=[r])}),f}const B={setup(){const a=[{parent_id:2,id:10,name:"10"},{parent_id:null,id:1,name:"1"},{parent_id:1,id:2,name:"2"},{parent_id:1,id:3,name:"3"},{parent_id:2,id:4,name:"4"},{parent_id:4,id:5,name:"5"}];console.log("\u{1F680} ~  initial list",a);const e=g(a,null,{childrenKey:"child"});console.log("\u{1F680} ~  initial finalTree",e);let o=async(d,n)=>{if(!n)return Promise.reject("\u4E0D\u80FD\u4E3A\u7A7A");let m;try{m=JSON.parse(n)}catch{}if(!m||!Array.isArray(m))return Promise.reject("\u8BE5\u6570\u7EC4\u6709\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165");Promise.resolve()};const t=k(),p=F({list:'[{"parent_id":null,"id":"1","name":"Label 1"},{"parent_id":"1","id":"2","name":"Label 2"},{"parent_id":"1","id":"3","name":"Label 3"},{"parent_id":"2","id":"4","name":"Label 4"},{"parent_id":"2","id":"5","name":"Label 5"}]',rootId:"",options:'{"parentKey":"parent_id","childrenKey":"children","idKey":"id"}'});return{formRef:t,layout:{labelCol:{span:4},wrapperCol:{span:14}},formState:p,rules:{list:[{required:!0,whitespace:!0,validator:o,trigger:"blur"}]},onSubmit:()=>{t.value.validate().then(()=>{const d=N(p),n=JSON.parse(d.list);console.log("\u{1F680} ~  list",n);let m;if(d.options)try{m=JSON.parse(d.options)}catch{}const y=g(n,d.rootId||null,m||null);console.log("\u{1F680} ~  finalTree",y)}).catch(d=>{})},resetForm:()=>{t.value.resetFields()}}}},E=j("p",null,"\u8BF7\u70B9\u51FBF12\u770Blog",-1),J=S("\u786E\u5B9A"),R=S("\u91CD\u7F6E");function U(a,e,o,t,f,p){const i=u("a-textarea"),r=u("a-form-item"),s=u("a-input"),_=u("a-button"),d=u("a-form");return O(),I(L,null,[E,l(d,w({ref:"formRef",model:t.formState,rules:t.rules},t.layout),{default:c(()=>[l(r,{label:"list",name:"list"},{default:c(()=>[l(i,{value:t.formState.list,"onUpdate:value":e[0]||(e[0]=n=>t.formState.list=n),"auto-size":""},null,8,["value"])]),_:1}),l(r,{label:"rootId",name:"rootId"},{default:c(()=>[l(s,{value:t.formState.rootId,"onUpdate:value":e[1]||(e[1]=n=>t.formState.rootId=n)},null,8,["value"])]),_:1}),l(r,{label:"options",name:"options"},{default:c(()=>[l(i,{value:t.formState.options,"onUpdate:value":e[2]||(e[2]=n=>t.formState.options=n),"auto-size":""},null,8,["value"])]),_:1}),l(r,{"wrapper-col":{span:14,offset:4}},{default:c(()=>[l(_,{type:"primary",onClick:t.onSubmit},{default:c(()=>[J]),_:1},8,["onClick"]),l(_,{style:{"margin-left":"10px"},onClick:t.resetForm},{default:c(()=>[R]),_:1},8,["onClick"])]),_:1})]),_:1},16,["model","rules"])],64)}var q=C(B,[["render",U]]);export{q as default};
